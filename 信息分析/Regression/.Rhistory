data <- read.csv("./archive/student-mat.csv")
head(data)
str(data)
data$sex <- as.factor(data$sex)
data$address <- as.factor(data$address)
data$famsize <- as.factor(data$famsize)
data$Pstatus <- as.factor(data$Pstatus)
data$Mjob <- as.factor(data$Mjob)
data$Fjob <- as.factor(data$Fjob)
data$reason <- as.factor(data$reason)
data$guardian <- as.factor(data$guardian)
data$schoolsup <- as.factor(data$schoolsup)
data$famsup <- as.factor(data$famsup)
data$paid <- as.factor(data$paid)
data$activities <- as.factor(data$activities)
data$nursery <- as.factor(data$nursery)
data$higher <- as.factor(data$higher)
data$internet <- as.factor(data$internet)
data$romantic <- as.factor(data$romantic)
str(data)
data$school <- as.factor(data$school)
data$sex <- as.factor(data$sex)
data$address <- as.factor(data$address)
data$famsize <- as.factor(data$famsize)
data$Pstatus <- as.factor(data$Pstatus)
data$Mjob <- as.factor(data$Mjob)
data$Fjob <- as.factor(data$Fjob)
data$reason <- as.factor(data$reason)
data$guardian <- as.factor(data$guardian)
data$schoolsup <- as.factor(data$schoolsup)
data$famsup <- as.factor(data$famsup)
data$paid <- as.factor(data$paid)
data$activities <- as.factor(data$activities)
data$nursery <- as.factor(data$nursery)
data$higher <- as.factor(data$higher)
data$internet <- as.factor(data$internet)
data$romantic <- as.factor(data$romantic)
str(data)
library(dplyr)
data <- select(data, -"school")
lm.model <- lm(Chance.of.Admit~.-1, data=data)
lm.model <- lm(G1~.-1, data=data)
lm.model
summary(lm.model)
lm.model <- lm(G3~., data=data)
lm.model
summary(lm.model)
lm.model <- lm(G3~.-1, data=data)
lm.model
summary(lm.model)
plot(lm.model)
vif(lm.model)
library(CAR)
library(car)
vif(lm.model)
influencePlot(lm.model)
library(car)
plot(lm.model)
vif(lm.model)
influencePlot(lm.model)
anova(lm.model)
vcov(lm.model)
anova(lm.model)
confint(lm.model)
anova(lm.model)
getwd()
data <- read.csv("./archive/student-mat.csv")
head(data)
str(data)
data$school <- as.factor(data$school)
data$sex <- as.factor(data$sex)
data$address <- as.factor(data$address)
data$famsize <- as.factor(data$famsize)
data$Pstatus <- as.factor(data$Pstatus)
data$Mjob <- as.factor(data$Mjob)
data$Fjob <- as.factor(data$Fjob)
data$reason <- as.factor(data$reason)
data$guardian <- as.factor(data$guardian)
data$schoolsup <- as.factor(data$schoolsup)
data$famsup <- as.factor(data$famsup)
data$paid <- as.factor(data$paid)
data$activities <- as.factor(data$activities)
data$nursery <- as.factor(data$nursery)
data$higher <- as.factor(data$higher)
data$internet <- as.factor(data$internet)
data$romantic <- as.factor(data$romantic)
str(data)
library(dplyr)
data_G1 <- select(data, -c("school", "G2", "G3"))
lm.model <- lm(G1~., data=data_G1)
lm.model
summary(lm.model)
lm.model <- lm(G1~.-1, data=data_G1)
lm.model
summary(lm.model)
lm.model <- lm(G1~., data=data_G1)
lm.model
summary(lm.model)
lm.model <- lm(G1~., data=data_G1)
summary(lm.model)
lm.model <- lm(G1~.-1, data=data_G1)
lm.model
summary(lm.model)
G1.model <- lm(G1~.sex+studytime+failures+schoolsup+famsup+goout-1,
data=data_G1)
G1.model <- lm(G1~sex+studytime+failures+schoolsup+famsup+goout-1,
data=data_G1)
lm.model
summary(lm.model)
G1.model <- lm(G1~sex+studytime+failures+schoolsup+famsup+goout-1,
data=data_G1)
summary(G1.model)
G1.model <- lm(G1~sex+studytime+failures+schoolsup+goout-1,
data=data_G1)
summary(G1.model)
G1.model <- lm(G1~sex+studytime+failures+schoolsup+famsup+goout-1,
data=data_G1)
summary(G1.model)
G1.model <- lm(G1~sex+studytime+failures+schoolsup+goout-1,
data=data_G1)
summary(G1.model)
library(car)
plot(G1.model)
vif(G1.model)
influencePlot(G1.model)
library(car)
vif(G1.model)
influencePlot(G1.model)
data_G1[c(3,79,199,233,249),]
data_G1[c(3,79,199,233,249),]
data_G1 <- data_G1[-c(3,79,199,233,249),]
G1.model2 <- lm(G1~sex+studytime+failures+schoolsup+goout-1,
data=data_G1)
summary(G1.model2)
# 残差自相关性检验
durbinWatsonTest(G1.model)
qqplot(G1.model)
influence.measures(G1.model)
# 离群值检验
influencePlot(G1.model)
# 共线性
vif(G1.model)
qqPlot(fit)
qqPlot(G1.model)
par(mfrow = c(2, 2))   # 设定画布大小
plot(G1.model)
crPlots(G1.model)
# 因变量幂次检验
spreadLevelPlot(G1.model)
# 共线性
vif(G1.model)
AIC(G1.model)
G1.model2 <- lm(G1~sex+studytime+failures+schoolsup+goout-1,
data=data_G1)
summary(G1.model2)
AIC(G1.model2)
G1.model2 <- lm(sqrt(G1)~sex+studytime+failures+schoolsup+goout-1,
data=data_G1)
summary(G1.model2)
AIC(G1.model2)
AIC(G1.model2)
# 检验是否正态
qqPlot(G1.model2)
# 检验是否线性
crPlots(G1.model2)
# 因变量幂次检验
spreadLevelPlot(G1.model2)
# 残差自相关性检验
durbinWatsonTest(G1.model2)
# 离群值检验
influencePlot(G1.model2)
G1.model2 <- lm(sqrt(sqrt(G1))~sex+studytime+failures+schoolsup+goout-1,
data=data_G1)
summary(G1.model2)
AIC(G1.model2)
G1.model2 <- lm(sqrt(sqrt(G1))~sex+studytime+failures+schoolsup+goout-1,
data=data_G1)
summary(G1.model2)
AIC(G1.model2)
AIC(G1.model2)
# 检验是否正态
qqPlot(G1.model2)
# 检验是否线性
crPlots(G1.model2)
# 因变量幂次检验
spreadLevelPlot(G1.model2)
# 残差自相关性检验
durbinWatsonTest(G1.model2)
# 离群值检验
influencePlot(G1.model2)
data_G3 <- select(data, -c("school"))
lm.model3 <- lm(G1~.-1, data=data_G1)
summary(lm.model3)
lm.model3 <- lm(G1~.-1, data=data_G3)
summary(lm.model3)
lm.model3 <- lm(G3~.-1, data=data_G3)
summary(lm.model3)
data_G3 <- select(data, -c("school","G1","G2"))
lm.model3 <- lm(G3~.-1, data=data_G3)
summary(lm.model3)
data_G3 <- select(data, -c("school","G2","G3"))
lm.model2 <- lm(G2~.-1, data=data_G2)
data_G2 <- select(data, -c("school","G2","G3"))
lm.model2 <- lm(G2~.-1, data=data_G2)
data_G2 <- select(data, -c("school","G3"))
lm.model2 <- lm(G2~.-1, data=data_G2)
summary(lm.model2)
lm.model2 <- lm(G2~G1.-1, data=data_G2)
lm.model2 <- lm(G2~G1-1, data=data_G2)
summary(lm.model2)
data_G3 <- select(data, -c("school"))
data_G3 <- select(data, -c("school"."G2"))
data_G3 <- select(data, -c("school","G2"))
lm.model2 <- lm(G3~G1-1, data=data_G3)
summary(lm.model2)
data_G3 <- select(data, -c("school","G2","G1"))
lm.model2 <- lm(G3~G1-1, data=data_G3)
lm.model2 <- lm(G3~.-1, data=data_G3)
summary(lm.model2)
lm.model2 <- lm(G3~sex+studytime+failures+schoolsup+goout-1, data=data_G3)
summary(lm.model2)
lm.model2 <- lm(sqrt(G3)~sex+studytime+failures+schoolsup+goout-1, data=data_G3)
summary(lm.model2)
lm.model2 <- lm(sqrt(sqrt(G3))~sex+studytime+failures+schoolsup+goout-1, data=data_G3)
summary(lm.model2)
lm.model2 <- lm(G3~-1, data=data_G3)
summary(lm.model2)
lm.model2 <- lm(G2~.-1, data=data_G2)
summary(lm.model2)
lm.model2 <- lm(G2~Fjob+traveltime+romantic+G1-1, data=data_G2)
summary(lm.model2)
lm.model2 <- lm(G2~traveltime+romantic+G1-1, data=data_G2)
summary(lm.model2)
G2.model <- lm(G2~traveltime+romantic+G1-1, data=data_G2)
summary(lm.model2)
AIC(G2.model)
# 检验是否正态
qqPlot(G2.model)
# 检验是否线性
crPlots(G2.model)
# 因变量幂次检验
spreadLevelPlot(G2.model) # 0.46,但是呈水平
# 残差自相关性检验
durbinWatsonTest(G2.model)
# 离群值检验
influencePlot(G2.model)
G2.model <- lm(G2~traveltime+romantic+G1+sex+studytime+failures+schoolsup+goout-1, data=data_G2)
summary(lm.model2)
G2.model <- lm(G2~traveltime+romantic+G1+sex+studytime+failures+schoolsup+goout-1, data=data_G2)
summary(G2.model)
G2.model <- lm(G2~traveltime+romantic+G1-1, data=data_G2)
summary(G2.model)
lm.model2 <- lm(G3~-1, data=data_G3)
summary(lm.model2)
lm.model2 <- lm(G3~.-1, data=data_G3)
summary(lm.model2)
data_G3 <- select(data, -c("school"))
lm.model2 <- lm(G3~.-1, data=data_G3)
summary(lm.model2)
lm.model2 <- lm(G3~famrel+absences+G2+G1-1, data=data_G3)
summary(lm.model2)
lm.model2 <- lm(G3~famrel+absences+G2-1, data=data_G3)
summary(lm.model2)
lm.model3 <- lm(G3~famrel+absences+G2-1, data=data_G3)
summary(lm.model3)
lm.model3 <- lm(G3~famrel+absences+G2, data=data_G3)
summary(lm.model3)
lm.model3 <- lm(G3~famrel+absences+G2-1, data=data_G3)
summary(lm.model3)
G3.model <- lm(G3~famrel+absences+G2-1, data=data_G3)
summary(G3.model)
AIC(G3.model)
# 检验是否正态
qqPlot(G3.model)
# 检验是否线性
crPlots(G3.model)
# 因变量幂次检验
spreadLevelPlot(G3.model) # 0.46,但是呈水平
# 残差自相关性检验
durbinWatsonTest(G3.model)
# 离群值检验
influencePlot(G3.model)
G3.model <- lm(G3~sqrt(famrel+absences+G2-1), data=data_G3)
summary(G3.model)
G3.model <- lm(I(G3^2)~famrel+absences+G2-1, data=data_G3)
summary(G3.model)
AIC(G3.model)
# 检验是否正态
qqPlot(G3.model)
# 检验是否线性
crPlots(G3.model)
# 因变量幂次检验
spreadLevelPlot(G3.model) # 0.46,但是呈水平
# 残差自相关性检验
durbinWatsonTest(G3.model)
# 离群值检验
influencePlot(G3.model)
G3.model <- lm(G3^2~famrel+absences+G2-1, data=data_G3)
summary(G3.model)
G3.model <- lm(G3~famrel+absences+G2-1, data=data_G3)
summary(G3.model)
AIC(G3.model)
# 检验是否正态
qqPlot(G3.model)
# 检验是否线性
crPlots(G3.model)
# 因变量幂次检验
spreadLevelPlot(G3.model) # 0.46,但是呈水平
# 残差自相关性检验
durbinWatsonTest(G3.model)
# 离群值检验
influencePlot(G3.model)
